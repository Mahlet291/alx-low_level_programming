More Functions more nesed loops